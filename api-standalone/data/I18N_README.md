# Internationalization (i18n) Guide

## Overview
This project includes a complete internationalization system supporting **English** and **Portuguese (Brazil)**. The default language is English.

## How It Works

### 1. Translation File: `js/i18n.js`
Contains all translations in a structured object:
```javascript
const translations = {
    en: { /* English translations */ },
    pt: { /* Portuguese translations */ }
};
```

### 2. HTML Implementation
Add `data-i18n` attribute to any element you want to translate:
```html
<h1 data-i18n="title">MUST PV19 Monitor</h1>
<button data-i18n="saveChanges">ðŸ’¾ Save Changes</button>
```

### 3. Language Selector
Both `index.html` and `settings.html` include a language selector:
```html
<select id="language-selector" onchange="changeLanguage(this.value)">
    <option value="en">English</option>
    <option value="pt">PortuguÃªs (BR)</option>
</select>
```

## Key Functions

### `loadLanguage()`
Loads the saved language from localStorage. Returns 'en' (default) if nothing is saved.

### `saveLanguage(lang)`
Saves the selected language to localStorage.

### `t(key)`
Gets translation for a specific key. Example:
```javascript
t('title')           // Returns "MUST PV19 Monitor" or "Monitor MUST PV19"
t('modes.charging')  // Returns "Charging" or "Carregando"
```

### `applyTranslations(lang)`
Applies all translations to elements with `data-i18n` attributes.

### `changeLanguage(lang)`
Changes the current language and applies translations immediately.

## Persistence

The selected language is stored in **localStorage** under the key `'language'`.

### Browser (Current Implementation)
```javascript
localStorage.setItem('language', 'en'); // or 'pt'
```

### Future: Server-Side Persistence
To save language preference to the server:
1. Add `language` field to `credentials.json` (dev-server)
2. Add `PREFS_KEY_LANGUAGE` to ESP32 Preferences
3. Create endpoint: `GET/POST /api/language`

## Adding New Translations

### 1. Add to `i18n.js`
```javascript
const translations = {
    en: {
        // ... existing translations
        newKey: "New English Text"
    },
    pt: {
        // ... existing translations
        newKey: "Novo Texto em PortuguÃªs"
    }
};
```

### 2. Add to HTML
```html
<span data-i18n="newKey">New English Text</span>
```

### 3. Dynamic Content
For content generated by JavaScript:
```javascript
element.textContent = t('newKey');
```

## Supported Pages
- âœ… `index.html` (Dashboard)
- âœ… `settings.html` (Settings)

## Default Language
English (`en`) is the default language. Users can switch to Portuguese (`pt`) at any time.

## Browser Compatibility
- Works in all modern browsers
- Uses localStorage API (IE8+)
- No external dependencies

## Testing
1. Open http://localhost:5000
2. Login with credentials (admin / G&n0101cori13)
3. Use the language selector in the header
4. Verify all text changes correctly
5. Refresh page - language should persist

## Files Modified
- `data/js/i18n.js` - NEW: Translation system
- `data/index.html` - Added language selector and data-i18n attributes
- `data/settings.html` - Added language selector and data-i18n attributes
- `data/js/app.js` - Added i18n initialization in DOMContentLoaded

## Translation Coverage
- Header and titles
- All dashboard cards (Battery, Solar, Charger, Inverter, Energy, System)
- All form labels and help text
- Buttons and links
- Status messages and alerts
- Inverter modes
- Loading states

## Next Steps (Optional)
1. Add language selector to ESP32 firmware (main.cpp)
2. Save preference to Preferences (EEPROM)
3. Add `/api/language` endpoint
4. Support more languages (Spanish, French, etc.)
